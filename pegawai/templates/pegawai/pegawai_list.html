{% extends 'pegawai/base.html' %} {% block title %}Daftar Pegawai{% endblock %}
{% block extra_head %}
<style>
  body {
    font-size: 10pt;
  }
  .card {
    font-size: 10pt;
  }
  table {
    font-size: 10pt;
  }
</style>
{% endblock %}
{% block content %}
<div class="card">
  <div class="card-header">
    <div class="d-flex justify-content-between align-items-center">
      <h3>Daftar Pegawai</h3>
      <form method="GET" class="d-flex">
        <input
          type="text"
          name="search"
          value="{{ search_query }}"
          placeholder="Cari berdasarkan nama pegawai..."
          class="form-control me-2"
        />
        <button type="submit" class="btn btn-outline-primary">
          <i class="fas fa-search"></i> Cari
        </button>
        {% if search_query %}
        <a
          href="{% url 'pegawai_list' %}"
          class="btn btn-outline-secondary ms-2"
        >
          <i class="fas fa-times"></i> Clear
        </a>
        {% endif %}
      </form>
    </div>
  </div>
  <div class="card-body">
    <a href="{% url 'pegawai_new' %}" class="btn btn-primary mb-3"
      ><i class="fas fa-plus"></i> Tambah Pegawai</a
    >
    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <thead class="table-dark">
          <tr>
            <th>Nama</th>
            <th>NIP</th>
            <th>Pangkat</th>
            <th>Golongan</th>
            <th>Jabatan</th>
            <th>Unit Kerja</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody>
          {% for p in page_obj %}
          <tr>
            <td>{{ p.nama }}</td>
            <td>{{ p.nip }}</td>
            <td>{{ p.pangkat }}</td>
            <td>{{ p.golongan }}</td>
            <td>{{ p.jabatan }}</td>
            <td>{{ p.unit_kerja }}</td>
            <td>
              <a
                href="{% url 'pegawai_edit' p.pk %}"
                class="btn btn-sm btn-warning"
                ><i class="fas fa-edit"></i
              ></a>
              <a
                href="{% url 'pegawai_delete' p.pk %}"
                class="btn btn-sm btn-danger"
                ><i class="fas fa-trash"></i
              ></a>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="7" class="text-center">
              {% if search_query %} Tidak ditemukan data untuk pencarian "{{
              search_query }}" {% else %} Tidak ada data {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    {% if page_obj.has_other_pages %}
    <nav aria-label="Page navigation">
      <ul class="pagination justify-content-center">
        {% if page_obj.has_previous %}
        <li class="page-item">
          <a
            class="page-link"
            href="?search={{ search_query }}&page=1"
            aria-label="First"
          >
            <span aria-hidden="true">&laquo;&laquo;</span>
          </a>
        </li>
        <li class="page-item">
          <a
            class="page-link"
            href="?search={{ search_query }}&page={{ page_obj.previous_page_number }}"
            aria-label="Previous"
          >
            <span aria-hidden="true">&laquo;</span>
          </a>
        </li>
        {% else %}
        <li class="page-item disabled">
          <a class="page-link" href="#" aria-label="Previous">
            <span aria-hidden="true">&laquo;</span>
          </a>
        </li>
        {% endif %}
        {% for num in page_obj.paginator.page_range %}
          {% if page_obj.number == num %}
        <li class="page-item active">
          <span class="page-link">{{ num }}</span>
        </li>
          {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
        <li class="page-item">
          <a class="page-link" href="?search={{ search_query }}&page={{ num }}">{{ num }}</a>
        </li>
          {% endif %}
        {% endfor %}
        {% if page_obj.has_next %}
        <li class="page-item">
          <a
            class="page-link"
            href="?search={{ search_query }}&page={{ page_obj.next_page_number }}"
            aria-label="Next"
          >
            <span aria-hidden="true">&raquo;</span>
          </a>
        </li>
        <li class="page-item">
          <a
            class="page-link"
            href="?search={{ search_query }}&page={{ page_obj.paginator.num_pages }}"
            aria-label="Last"
          >
            <span aria-hidden="true">&raquo;&raquo;</span>
          </a>
        </li>
        {% else %}
        <li class="page-item disabled">
          <a class="page-link" href="#" aria-label="Next">
            <span aria-hidden="true">&raquo;</span>
          </a>
        </li>
        {% endif %}
      </ul>
    </nav>

    <!-- Page info -->
    <div class="mt-3 text-center">
      <small class="text-muted">
        {% if search_query %} Menampilkan {{ page_obj.start_index }} sampai {{ page_obj.end_index }} dari {{ page_obj.paginator.count }} pegawai untuk
        pencarian "{{ search_query }}" {% else %} Menampilkan {{ page_obj.start_index }} sampai {{ page_obj.end_index }} dari {{ page_obj.paginator.count }} pegawai {% endif %}
      </small>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
